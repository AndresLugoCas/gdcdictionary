$schema: "http://json-schema.org/draft-04/schema#"

id: external_alignment
title: External Alignment
type: object
description: External Alignment
additionalProperties: false
category: data_bundle
validators: null
project: '*'
program: '*'

systemProperties:
  - id
  - project_id
  - created_datetime
  - updated_datetime
  - state
  - release_state
  - release_state_datetime

links:
  - name: aliquots
    label: derived_from
    target_type: aliquot
    multiplicity: many_to_one
    required: true
    backref: external_alignments

required:
  - ref_assembly_build
  - aligner_name
  - read_trimmed

uniqueKeys:
  - [ id ]
  - [ project_id, submitter_id ]

properties:
  id:
    $ref: "_definitions.yaml#/UUID"
    systemAlias: node_id
  project_id:
    type: string
  state:
    $ref: "_definitions.yaml#/data_file_state"
  type:
    enum: [ "external_alignment" ]
  submitter_id:
    type:
      - string
      - "null"
  analysis_center:
    description: "Analysis Center"
    type: string
  analysis_date:
    description: "Date of Analysis Completed"
    type: string
    format: date
  analysis_pipeline_name:
    description: "Name (and version) of Analysis Pipeline"
    type: string
  ref_assembly_build:
    description: "Reference Build"
    enum:
      - GRCh36/Hg18
      - GRCh37/Hg19
      - GRCh38
  ref_assembly_name:
    description: "Short Name of Reference Used"
    type: string
  ref_assembly_url:
    description: "Reference FastA File URL"
    type: string
  aligner_name:
    description: "Aligner"
    type: string
    enum:
      - BWA_MEM
      - BAW_ALN
      - other
  aligner_version:
    description: "Aligner Version"
    type: string
  alignment_command:
    description: "Alignment Command"
    type: string
  read_trimmed:
    description: "Were reads trimmed for any reasons"
    type: boolean
  GDC_pipeline_compliant:
    description: "Could GDC take it as is?"
    type: boolean
  program_name:
    description: "Name of programs other than aligner"
    type: array
    items:
      type: string
  program_version:
    description: "Program Version"
    type: array
    items:
      type: string
  program_command:
    description: "Program Command"
    type: array
    items:
      type: string
  aliquots:
      $ref: "_definitions.yaml#/to_one"
  created_datetime:
      $ref: "_definitions.yaml#/datetime"
  updated_datetime:
      $ref: "_definitions.yaml#/datetime"

  # ======== Release state ========
  release_state:
      $ref: "_definitions.yaml#/release_state"
  release_state_datetime:
      $ref: "_definitions.yaml#/datetime"
