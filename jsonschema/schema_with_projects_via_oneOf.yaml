#####################################################################
# Proposed additional keywords
#
# systemAlias: For implementation. Allows properties to be stored as
#     different keywords.  The property listed in the properties
#     section is what the user will refer to it, and the systemAlias
#     value is what it will be stored in the database as.
#
# systemProperties: The property keys listed under systemProperties
#     are properties that the submitter is not allowed to update.
#
# parentType: The type of object that the parent relationship points
#     to.
#
#####################################################################

$schema: "http://json-schema.org/draft-04/schema#"

#####################################################################
# Reusable reference definitions
#####################################################################

definitions:
    UUID:
        type: string
        pattern: "^[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}$"

    parent_uuids:
        type: array
        minItems: 1
        items:
          $ref: "#/definitions/UUID"
        uniqueItems: true

#####################################################################
# Aliquot
#####################################################################

aliquot:

# Aliquot meta
  type: object
  title: Aliquot
  project: '*'
  description: "TODO"
  additionalProperties: false
  systemProperties:
    - aliquot_id
    - project
  required:
    - submitter_aliquot_id
    - parents

  ### Attempt to do project level schema via 'oneOf'
  # oneOf:
  #   - title: "overrides: project 1"
  #     type: object
  #     required:
  #       - project_1_specific_thing
  #     properties:
  #       project: {enum: [project1]}

# Aliquot properties
  properties:
    project:
      type: string
    type:
      type: string
    aliquot_id:
      $ref: "#/definitions/UUID"
      systemAlias: node_id
      description: "TODO"
    submitter_aliquot_id:
      type: string
      description: "TODO"
    submitter_case_id:
      type: string
      description: "TODO"
    submitter_analyte_id:
      type: string
      description: "TODO"
    submitter_sample_id:
      type: string
      description: "TODO"

# Aliquot parents
    parents:
      type: object
      additionalProperties: false
      required:
        - analyte_ids
      properties:
        analyte_ids:
          $ref: "#/definitions/parent_uuids"
          parentType: analyte
