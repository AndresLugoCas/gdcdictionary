schema:
  name: diagnosis
  namespace: gdc.nci.nih.gov
  category: clinical
  title: Diagnosis
  description: 
  version: 
  created:
  updated:
  required: true
  data_format:
    - TSV
    - JSON
    - XML
  validator: standard
  projects: ["TCGA-BRCA", "TCGA-OV", "TARGET-ALL", "ABCD", "XYZ"]
  system_fields:
    -
      name: id
      type: uuid
      description:
      constraints:
        required: true
        unique: true
    -
      name: version
      type: integer
      description:
      constraints:
        required: true
        unique: true
    -
      name: state
      type: string
      description:
      constraints:
        required: true
        unique: false
        allowed: [ registered, live ]
    -
      name: date_created
      type: datetime
      description:
      constraints:
        required: true
        unique: false
    -
      name: date_updated
      type: datetime
      description:
      constraints:
        required: true
        unique: false
  fields:
    -
      name: submitter_diagnosis_id
      type: string
      description:
      constraints:
        required: false # submitter may not have ID for this, which we should allow
        unique: false  # within project is unique
    -
      name: submitter_case_id
      type: string
      constraints:
        required: true
        projects: [ _all ]
    -
      name: case_id  # case_id is the system-generated short ID for case, submitter could use it for referencing the parent case
      type: string
      constraints:
        required: false
    -
      name: diagnosis
      type: string
      constraints:
        required: true
        unique: false
        projects: [ _all ]
    -
      name: age_at_diagnosis
      type: string
      unit: year  # need controlled list of supported units
      constraints:
        required: true
        unique: false
        projects: [ _all ]
    -
      name: prior_malingnancy
      type: string
      constraints:
        required: false
        unique: false
        projects:
          -
            BRCA: # this is a way to overwrite system default setting
              required: true
              name: prior_disease
          - OV:
              required: true
  primaryKey: id
  # relationship to parent entity can be specified by using
  # either system-generated keys or submitter's IDs.
  # Semantically there shouldn't be any difference, it's a matter of 
  # convenience. For example, for related clinical schemas (case & diagnosis) it may
  # make more sense to use submitter's ID, so that submitter can
  # fully specify and maintain the relationships on their own side,
  # for example in the BCR case. BCR should not need to know anything
  # about GDC assigned IDs (neither internal id nor short code)
  # However, for harmonization workflows, as the IDs are not usually
  # managed by user, system-generated IDs will need to be used for
  # specifying relationships
  parentKeys:
    -
      fields: submitter_case_id
      required: true
      reference:
        entity: case
        fields: submitter_case_id
    -
      # this is the same relation as the above. Submitter should
      # choose just either one of these, how do we express the mutually exclusive options?
      # maybe should merge these two into one (since it is indeed one relation), then somehow
      # may the fields for linking mutually exclusive
      fields: case_id
      required: false
      reference:
        entity: case
        fields: case_id
